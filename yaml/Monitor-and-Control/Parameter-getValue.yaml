asyncapi: 3.0.0
info:
  title: Parameter Service getValue API
  version: 1.0.0
  description: This API allows clients to interact with the getValue iteraction of the Parameter Service.
defaultContentType: application/json
servers:
  production:
    host: 'localhost:{port}'
    protocol: mqtt
    description: MQTT server for the getValue interaction.
    variables:
      port:
        enum:
          - '8883'
          - '8884'
        default: '8883'
    bindings:
      mqtt:
        clientId: guest
        cleanSession: false
        keepAlive: 0
        lastWill:
          topic: /will
          qos: 0
          message: Guest gone offline.
          retain: false
channels:
  Send_Parameter_getValue:
    address: Send_Parameter_getValue
    messages:
      Parameter.getValue_Send.message:
        $ref: '#/components/messages/Parameter_getValue_Send'
    description: >
      Send a **Parameter_getValue_Send** message in this channel to receive a
      **Parameter_getValue_Receive** message over the **Receive_Parameter_getValue** channel.
  Receive_Parameter_getValue:
    address: Receive_Parameter_getValue
    messages:
      Parameter.getValue_Receive.message:
        $ref: '#/components/messages/Parameter_getValue_Receive'
    description: >
      Use this channel to receive Parameter getValue responses as **Parameter_getValue_Receive**
      messages.
  Error_Parameter_getValue:
    address: Error_Parameter_getValue
    messages:
      Parameter.getValue_Error.message:
        $ref: '#/components/messages/Parameter_getValue_Error'
    description: >
      Use this channel to receive Parameter getValue errors as **Parameter_getValue_ReceiveErrors**
      messages.
operations:
  Parameter_getValue_Send:
    action: send
    channel:
      $ref: '#/channels/Send_Parameter_getValue'
    messages:
      - $ref: '#/channels/Send_Parameter_getValue/messages/Parameter.getValue_Send.message'
  Parameter_getValue_Receive:
    action: receive
    channel:
      $ref: '#/channels/Receive_Parameter_getValue'
    messages:
      - $ref: '#/channels/Receive_Parameter_getValue/messages/Parameter.getValue_Receive.message'
  Parameter_getValue_Error:
    action: receive
    channel:
      $ref: '#/channels/Error_Parameter_getValue'
    messages:
      - $ref: '#/channels/Error_Parameter_getValue/messages/Parameter.getValue_Error.message'
components:
  schemas:
    Parameter_getValue_Send:
      type: object
      properties:
        transactionId:
          type: string
          description: A unique identifier to map the response to the request.
        paramInstIds:
          type: array
          items:
            type: integer
            format: int64
          description: |
            The paramInstIds field shall provide the list of ParameterIdentity object instance identifiers.
            The wildcard value of '0' shall be supported and matches all parameters of the provider.
            The wildcard value should be checked for first, if found no other checks of supplied object instance identifiers shall be made.
            If a requested parameter is unknown then an UNKNOWN error shall be returned.
            If a parameter is being reported periodically, using the operation shall not reset the reportInterval timer.
    Parameter_getValue_Receive:
      type: object
      properties:
        transactionId:
          type: string
          description: A unique identifier to map the response to the request.
        paramValDetails:
          $ref: '#/components/schemas/mc/parameter/ParameterValueDetails'
          description: |
            The response shall contain a list of returned ParameterIdentity and ParameterDefinition object instance identifier pairs and a matching list of parameter values.
            The new value shall not be published via the monitorValue operation.
    Parameter_getValue_Error:
      type: object
      properties:
        transactionId:
          type: string
          description: A unique identifier to map the response to the request.
        area:
          type: string
          description: The area in which the error applies.
          enum:
            - MAL
        name:
          type: string
          description: A code representing the error.
          enum:
            - UNKNOWN
        extraInformation:
          type: array
          items:
            type: integer
            format: uint32
            description: A list of the indexes of the error values shall be contained in the extra information field.
    mc:
      parameter:
        ParameterValue:
          properties:
            convertedValue:
              description: The parameter converted value.
              type: string
            rawValue:
              description: The parameter raw value. The value of NULL is a valid value and carries
                no special significance in the parameter service.
              type: string
            validityState:
              description: Holds the validity state for a parameter value. If the parameter
                is valid then this should be set to '0'.
              format: uint8
              type: integer
          type: object
        ParameterValueDetails:
          properties:
            defId:
              description: The ParameterDefinition object instance identifier.
              format: int64
              type: integer
            paramId:
              description: The ParameterIdentity object instance identifier.
              format: int64
              type: integer
            timestamp:
              description: The timestamp of the value.
              format: uint64
              type: number
            value:
              $ref: '#/components/schemas/mc/parameter/ParameterValue'
              description: The parameter value.
          type: object
  messages:
    Parameter_getValue_Send:
      description: Parameter getValue request submission
      payload:
        $ref: '#/components/schemas/Parameter_getValue_Send'
    Parameter_getValue_Receive:
      description: Parameter getValue update response
      payload:
        $ref: '#/components/schemas/Parameter_getValue_Receive'
    Parameter_getValue_Error:
      description: Parameter getValue error response
      payload:
        $ref: '#/components/schemas/Parameter_getValue_Error'
